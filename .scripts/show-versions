#!/bin/bash

# Function to display version information
show_versions() {
    local versions_file="$HOME/.scripts/versions"
    
    if [ ! -f "$versions_file" ]; then
        echo "No versions file found."
        return 1
    fi
    
    echo "Tracked Application Versions:"
    echo "============================"
    while IFS='=' read -r app version; do
        # Skip comments and empty lines
        if [[ -n "$app" && -n "$version" && ! "$app" =~ ^# ]]; then
            printf "%-20s: %s\n" "$app" "$version"
        fi
    done < "$versions_file"
    echo "============================"
}

# Function to show help
show_help() {
    echo "Usage: versions [app_name]"
    echo ""
    echo "Options:"
    echo "  app_name    Show version for specific application"
    echo "  -h, --help  Show this help message"
    echo ""
    echo "If no arguments provided, shows all tracked versions."
}

# Main script logic
case "$1" in
    -h|--help)
        show_help
        ;;
    "")
        show_versions
        ;;
    *)
        # Show version for specific app
        local versions_file="$HOME/.scripts/versions"
        if [ ! -f "$versions_file" ]; then
            echo "No versions file found."
            exit 1
        fi
        
        local version=$(grep "^$1=" "$versions_file" 2>/dev/null | cut -d'=' -f2)
        if [ -n "$version" ]; then
            echo "$1: $version"
        else
            echo "No version found for '$1'"
            exit 1
        fi
        ;;
esac
