{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://maestro.flow.dev/schemas/historical-task-ordering.schema.json",
  "title": "Historical Task Ordering Decisions",
  "description": "Historical record of task ordering and prioritization decisions for dependency resolution and parallelization",
  "type": "object",
  "required": ["sessions"],
  "properties": {
    "version": {
      "type": "string",
      "description": "Schema version",
      "default": "1.0"
    },
    "last_updated": {
      "type": "string",
      "description": "Last update timestamp",
      "format": "date-time"
    },
    "sessions": {
      "type": "array",
      "description": "Historical task ordering sessions",
      "items": {
        "type": "object",
        "required": [
          "session_id",
          "timestamp",
          "feature_summary",
          "ordering_strategy",
          "task_groups"
        ],
        "properties": {
          "session_id": {
            "type": "string",
            "description": "Session identifier",
            "format": "uuid"
          },
          "timestamp": {
            "type": "string",
            "description": "When ordering was decided",
            "format": "date-time"
          },
          "feature_summary": {
            "type": "string",
            "description": "Brief feature description"
          },
          "total_tasks": {
            "type": "integer",
            "description": "Total number of tasks",
            "minimum": 0
          },
          "ordering_strategy": {
            "type": "object",
            "description": "Strategy used for task ordering",
            "properties": {
              "primary_approach": {
                "type": "string",
                "description": "Main ordering approach",
                "enum": [
                  "foundational_first",
                  "risk_early",
                  "dependency_driven",
                  "parallel_maximization",
                  "hybrid"
                ]
              },
              "grouping_method": {
                "type": "string",
                "description": "How tasks were grouped",
                "enum": [
                  "by_dependency",
                  "by_risk",
                  "by_domain",
                  "by_parallel_safety",
                  "no_grouping"
                ]
              },
              "parallelization_level": {
                "type": "string",
                "description": "Level of parallelization",
                "enum": ["none", "low", "medium", "high", "maximum"]
              }
            }
          },
          "task_groups": {
            "type": "array",
            "description": "Task groups and their execution order",
            "items": {
              "type": "object",
              "required": ["group_id", "order", "task_count"],
              "properties": {
                "group_id": {
                  "type": "string",
                  "description": "Group identifier (e.g., P:Group-1)"
                },
                "order": {
                  "type": "integer",
                  "description": "Execution order (1 = first)",
                  "minimum": 1
                },
                "task_count": {
                  "type": "integer",
                  "description": "Number of tasks in group",
                  "minimum": 0
                },
                "parallel": {
                  "type": "boolean",
                  "description": "Whether tasks in this group run in parallel"
                },
                "dependencies": {
                  "type": "array",
                  "description": "Groups this depends on",
                  "items": {
                    "type": "string"
                  }
                },
                "grouping_rationale": {
                  "type": "string",
                  "description": "Why these tasks were grouped together"
                },
                "risk_level": {
                  "type": "string",
                  "description": "Risk level of tasks in this group",
                  "enum": ["low", "medium", "high"]
                }
              }
            }
          },
          "critical_path": {
            "type": "array",
            "description": "Critical path tasks that determine minimum duration",
            "items": {
              "type": "string"
            }
          },
          "dependency_analysis": {
            "type": "object",
            "description": "Analysis of task dependencies",
            "properties": {
              "total_dependencies": {
                "type": "integer",
                "description": "Total number of dependencies",
                "minimum": 0
              },
              "max_depth": {
                "type": "integer",
                "description": "Maximum dependency chain depth",
                "minimum": 0
              },
              "bottleneck_tasks": {
                "type": "array",
                "description": "Tasks that many others depend on",
                "items": {
                  "type": "string"
                }
              }
            }
          },
          "outcome": {
            "type": "object",
            "description": "Outcome of this task ordering",
            "properties": {
              "all_tasks_completed": {
                "type": "boolean"
              },
              "reordering_required": {
                "type": "boolean",
                "description": "Was reordering necessary during execution?"
              },
              "blocking_issues": {
                "type": "integer",
                "description": "Number of blocking issues encountered",
                "minimum": 0
              },
              "parallel_efficiency": {
                "type": "number",
                "description": "Efficiency of parallelization (0-1)",
                "minimum": 0,
                "maximum": 1
              },
              "lessons_learned": {
                "type": "string",
                "description": "Key lessons for future ordering"
              }
            }
          }
        }
      }
    },
    "patterns": {
      "type": "object",
      "description": "Learned patterns from historical task ordering",
      "properties": {
        "effective_patterns": {
          "type": "array",
          "description": "Patterns that led to successful execution",
          "items": {
            "type": "object",
            "properties": {
              "pattern": {
                "type": "string",
                "description": "Pattern description"
              },
              "success_rate": {
                "type": "number",
                "minimum": 0,
                "maximum": 1
              },
              "applicable_scenarios": {
                "type": "array",
                "description": "When to apply this pattern",
                "items": {
                  "type": "string"
                }
              }
            }
          }
        },
        "ordering_rules": {
          "type": "array",
          "description": "Learned rules for task ordering",
          "items": {
            "type": "object",
            "properties": {
              "rule": {
                "type": "string",
                "description": "Rule description"
              },
              "priority": {
                "type": "string",
                "description": "Rule priority",
                "enum": ["high", "medium", "low"]
              },
              "confidence": {
                "type": "number",
                "description": "Confidence in this rule (0-1)",
                "minimum": 0,
                "maximum": 1
              },
              "supporting_evidence": {
                "type": "integer",
                "description": "Number of sessions supporting this rule",
                "minimum": 0
              }
            }
          }
        },
        "anti_patterns": {
          "type": "array",
          "description": "Ordering patterns to avoid",
          "items": {
            "type": "object",
            "properties": {
              "pattern": {
                "type": "string"
              },
              "reason": {
                "type": "string"
              },
              "negative_outcomes": {
                "type": "array",
                "description": "Negative outcomes observed",
                "items": {
                  "type": "string"
                }
              }
            }
          }
        },
        "category_best_practices": {
          "type": "object",
          "description": "Best practices by task category",
          "additionalProperties": {
            "type": "object",
            "properties": {
              "typical_position": {
                "type": "string",
                "description": "Where tasks of this category typically belong",
                "enum": ["early", "middle", "late", "flexible"]
              },
              "parallel_safe": {
                "type": "boolean",
                "description": "Can this category run in parallel?"
              },
              "dependencies": {
                "type": "array",
                "description": "Typical dependencies",
                "items": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    }
  }
}
